# 一、系统整体架构
```bash
前端 (index.html + JS)
   ├─ 角色选择、录音、播放
   ├─ 调用接口：/asr → /chat → /tts
   ↓
后端 FastAPI (main.py)
   ├─ /asr/   → 调用 ASR 服务 (FunASR)
   ├─ /chat/  → 调用 LLM 服务 (Qwen-Turbo)
   ├─ /tts/   → 调用 TTS 服务 (XTTS-v2)
   ├─ /voices → 静态音色文件
   └─ /index.html → 前端页面
   ↓
服务层 (services/)
   ├─ asr_service.py  → 语音转文本
   ├─ llm_service.py  → 角色 Prompt + 用户输入 → 回复
   └─ tts_service.py  → 文本 + 音色 → 语音
   ↓
数据与资源
   ├─ models/  → XTTS 模型文件
   └─ voices/  → 参考音色 wav 文件
```
## 二、模块规格说明

| 模块 | 文件/目录 | 功能 |
|------|-----------|------|
| 前端页面 | index.html | 提供角色选择、录音、调用 API、播放合成语音 |
| 主入口 | main.py | 启动 FastAPI，挂载路由和静态文件 |
| ASR 路由 | routers/asr.py | 接收音频，调用 asr_service.py 返回识别文本 |
| Chat 路由 | routers/chat.py | 接收文本和角色 Prompt，调用 llm_service.py 返回回复 |
| TTS 路由 | routers/tts.py | 接收文本和参考音频，调用 tts_service.py 返回语音 |
| 配置 | core/config.py | 读取 .env，配置 API Key、模型路径 |
| 模型 | models/ | 存放 XTTS-v2 模型文件 |
| 角色音色库 | voices/ | 存放参考音色 wav 文件 |

---

## 三、团队分工

- **周业川**：整体架构设计、TTS 模块实现、依赖管理、ASR 模块开发与测试、Chat 模块开发、LLM API 接入    
- **李文贤**：前端页面开发、录音与播放逻辑  

---

# 议题二产品说明

## 1. 面向用户与痛点

- **目标用户**  
  - 文学/影视/游戏爱好者：希望与虚拟角色互动（如哈利波特、三国人物）。  
  - 学习者/教育者：希望通过角色对话练习语言、学习哲学思辨。  
  - 内容创作者/主播：需要快速生成角色语音对话，用于视频或直播。  

- **痛点**  
  - 现有聊天机器人缺乏角色沉浸感。  
  - 文本聊天缺乏声音表现力。  
  - 搭建多模态对话系统门槛高。  

- **用户故事**  
  - 作为哈利波特粉丝，我希望能和“哈利波特”语音对话，听到他以魔法世界的身份回答问题。  
  - 作为哲学学生，我希望能和“苏格拉底”对话，体验被提问和引导思考的过程。  
  - 作为视频创作者，我希望能快速生成“武将”角色的语音台词，用于短视频。  

---

## 2. 功能与优先级

- **核心功能（高优先级）**  
  - 角色搜索与选择  
  - 语音识别（ASR）  
  - 角色对话（LLM）  
  - 语音合成（TTS）  

- **增强功能（中优先级）**  
  - 参考音色克隆  
  - 错误处理与兜底逻辑  

- **扩展功能（低优先级）**  
  - 对话上下文记忆  
  - 多角色切换与管理  
  - 实时流式语音  

- **本次开发范围**  
  - 已实现：角色选择、ASR/LLM/TTS 闭环、参考音色（界徐盛、黍等）。  
  - 暂未实现：高级记忆、实时流式。  

---

## 3. LLM 模型选择

- **对比模型**  
  - Qwen-Turbo：中英文平衡好，延迟低，成本可控。  
  - DeepSeek：推理能力强，但 API 稳定性待验证。  
  - Claude/GPT：效果好，但成本高、延迟大。  

- **最终选择**  
  - **Qwen-Turbo**：  
    - 中文表现优秀，适合三国/国风角色。  
    - 延迟和成本适合实时语音交互。  
    - Prompt 遵循度高，角色扮演稳定。  

---

## 4. AI 角色技能设计

除语音聊天外，角色还应具备以下技能（通过 Prompt 约束实现）：  

1. **角色一致性**：保持语气、价值观、世界观不出戏。  
2. **哲学提问**：通过反问引导用户思考。  
3. **故事讲述**：引用背景故事，增强沉浸感。  
4. **语言练习**：可切换中英文，帮助用户练习语言。  
5. **情绪激励**：在合适场景下给出鼓励性回应。  

> 本次提交至少实现前三个技能。  

---

## 5. Demo 视频说明

- **展示内容**  
  - 启动后端服务  
  - 打开网页，选择角色（如界徐盛、黍）  
  - 录音提问 → ASR → Chat → TTS → 播放语音  
  - 展示 Swagger /docs 接口  

---